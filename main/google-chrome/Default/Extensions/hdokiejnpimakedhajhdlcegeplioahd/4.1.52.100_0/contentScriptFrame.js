LPFrame=function(){var e=0,t={},n=null,i=function(){var e=function(e){return"string"==typeof e?e:"number"==typeof e?e+"px":""};return function(t,n){for(var i in n)t.style.setProperty(i,e(n[i]),"important");return t}}(),r=function(n){var r=++e,o=n.tracking,s=null,a=new LPEventManager,c=[],l=null,u=null,f=n.interfaceDefinition;t[r]=this;var d=function(){var e=document.createElement("iframe"),t=getchromeurl(n.url);t+=(t.indexOf("?")>-1?"&":"?")+"dialogID="+r,g_isfirefoxsdk?e.setAttribute("lpsrc",t):e.src=t,i(e,{border:"none",position:"relative",height:"100%",width:"100%",visibility:"visible"}),e.setAttribute("scrolling","no");var o=document.createElement("div");return i(o,{position:"fixed","z-index":"2147483647",display:"none",width:"100%",height:"100%"}),o.appendChild(e),document.body.appendChild(o),o}();this.close=function(){a.publishEvent("close"),d.parentElement.removeChild(d),window.removeEventListener("resize",this.refreshPosition),window.removeEventListener("scroll",this.refreshPosition),delete t[r]},this.onClose=function(e){a.addEventListener("close",e)},this.css=function(e){i(d,e),this.refreshPosition()};var h=function(e,t,n){if(n){if("string"==typeof n){if(!n.indexOf("%"))throw"trackElement only supports numbers or percentages for translations";n=e[t]*parseInt(n.substring(0,n.indexOf("%")))/100}return n}return 0};this.refreshPosition=function(){if(o){var e=o.element.getBoundingClientRect(),t=e.top,n=e.left;o.frameTranslation&&(t+=h(d,"clientHeight",o.frameTranslation.y),n+=h(d,"clientWidth",o.frameTranslation.x)),o.targetTranslation&&(t+=h(o.element,"clientHeight",o.targetTranslation.y),n+=h(o.element,"clientWidth",o.targetTranslation.x)),i(d,{top:t,left:n})}},this.trackElement=function(e){o=e,window.addEventListener("resize",this.refreshPosition),window.addEventListener("scroll",this.refreshPosition)},this.getInterface=function(){return null===u&&(l=function(e){null===s?c.push(e):LPPlatform.requestFramework.sendRequest({type:"contentScriptRequest",data:e,frameID:s})},u=Interfaces.createInstance(f,{direct:!1,context:"contentScript",requestFunction:l})),u},this.setFrameID=function(e){s=e;for(var t=0;t<c.length;++t)l(c[t])},this.getDialogID=function(){return r},o&&this.trackElement(o)};Topics.get(Topics.CLEAR_DATA).subscribe(function(){for(var e in t)t[e].close()});var o=function(e){if(e){var n=t[e.id];n&&n.css(e.css)}"function"==typeof e.callback&&e.callback()},s=function(e){var n=t[e];n&&n.close()},a=function(e,n){var i=t[e];i&&i.setFrameID(n)},c=function(e){null===n&&(n=document.createElement("div"),i(n,{position:"fixed","z-index":"2147483646",top:"0px",right:"0px",bottom:"0px",left:"0px","background-color":"rgba(52, 61, 68, 0.6)"})),document.body.appendChild(n)},l=function(){n&&document.body.removeChild(n)},u=function(e){return new r(e)};return{css:o,close:s,openDialog:function(e,t,n){var i=u({url:"contentScriptDialog.html",interfaceDefinition:Interfaces.ContentScriptDialogInterface});return i.getInterface().LPDialog.openDialog(e,t),n&&(n.css&&i.css(n.css),n.callback&&n.callback(i.getDialogID())),i},openFrame:u,initializeRequestFramework:a,showModal:c,hideModal:l,hasDialogs:function(){return!(t&&0===Object.keys(t).length&&t.constructor===Object)}}}();